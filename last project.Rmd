
---
title: "Scenario C – Correlational Analyst"
author: "Ishara Nirmal"
date: "2025/11/06"
output: Rnotebook
---

```{r}
install.packages(c("readr","dplyr","ggplot2","tidyr","GGally","broom"))

```

```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(GGally)
library(broom)
```




```{r}
data <- read_csv("C:\\Users\\admin\\OneDrive\\Desktop\\DPR\\who_ambient_air_quality_database_version_2024_(v6.1) (1).csv")

```

```{r}
colnames(data)  # show the column names of the data frame called data.
```

```{r}
glimpse(data)
```

```{r}
View(data)
```



```{r}
head(data)
```

```{r}
colSums(is.na(data))

```
```{r}
data$pm25_concentration[is.na(data$pm25_concentration)] <- median(data$pm25_concentration, na.rm = TRUE)
data$pm10_concentration[is.na(data$pm10_concentration)] <- median(data$pm10_concentration, na.rm = TRUE)
data$no2_concentration[is.na(data$no2_concentration)] <- median(data$no2_concentration, na.rm = TRUE)

```


```{r}
colSums(is.na(data))
```

```{r}
data$year[is.na(data$year)] <- median(data$year, na.rm = TRUE)
data <- data %>%
  select(-reference, -web_link, -population_source, -pm10_tempcov, -pm25_tempcov, -no2_tempcov, -type_of_stations, -population )

```

```{r}
data <- data %>%
  filter(!is.na(latitude), !is.na(longitude))
colSums(is.na(data))

```
```{r}
data_clean <- data %>%
  select(country_name, city, year, 
         pm10_concentration, pm25_concentration, no2_concentration)
data
```


```{r}
df_corr <- data %>% select(pm10_concentration, pm25_concentration, no2_concentration)
cor(df_corr, use = "complete.obs", method = "pearson")

```
```{r}
GGally::ggpairs(df_corr)

```

```{r}


ggplot(data, aes(x = pm10_concentration, y = pm25_concentration)) +
  geom_point(alpha = 0.3, size = 1.5, color = "darkblue") +  
  geom_smooth(method = "lm", se = TRUE, color = "red", size = 1) +  
  labs(
    title = "PM10 vs PM2.5 Concentrations",
    x = "PM10 (µg/m³)",
    y = "PM2.5 (µg/m³)"
  ) +
  theme_minimal(base_size = 14)  

```


```{r}
model <- lm(pm25_concentration ~ pm10_concentration, data = data)
summary(model)

```
```{r}
cor_test <- cor.test(data$pm25_concentration, data$pm10_concentration, method = "pearson")
cor_test

```







